MODULE EvalScript;

REQUIRE System, Utils;

NAMESPACE System;

scriptStorage 'Скрипт' () = DATA TEXT ();

scriptExecution 'Выполнить скрипт' () = ACTION EVAL scriptStorage();

actionBodyExecution 'Выполнить действие' () = ACTION EVAL CONCAT ' ', 'run() = ACTION {', scriptStorage(), ';\n};';
formExecution 'Показать форму' () = ACTION EVAL CONCAT ' ', 'FORM form', scriptStorage(), ';\nrun() = ACTION FORM form;';

FORM script 'Скрипт'
    PROPERTIES() scriptStorage,
                 scriptExecution, actionBodyExecution, formExecution
;

DESIGN script FROM DEFAULT {
    ADD PROPERTY(scriptStorage) {
        panelLabelAbove = TRUE;    
        fill = 1;
    }
    NEW run {
        caption = 'Запуск';
        type = CONTAINERH;
        ADD PROPERTY(scriptExecution) { font = 'Tahoma bold 24'; }
        ADD PROPERTY(actionBodyExecution) { font = 'Tahoma bold 24'; }
        ADD PROPERTY(formExecution) { font = 'Tahoma bold 24'; }
    }
    ADD functions.box;
}

NAVIGATOR {
    configuration {
        ADD script;
    }
}

