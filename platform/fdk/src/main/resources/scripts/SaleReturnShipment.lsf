MODULE SaleReturnShipment;

REQUIRE Shipment, SaleReturnInvoice
;

NAMESPACE SaleReturn;


//----------------------------------------------- Поставка ---------------------------------------------------//

@defineShipment(inLIFOSkuLedger, ' (продажа-возврат)', customer, 'Покупатель', company, customer);
@defineShipmentBatch();

// Берем учетную цену
@deriveDocumentDetailPriceBatchStockPrefix(userInvoice, shipment);
@deriveDocumentDetailPriceBatchStock(userShipment);

// Проводим по регистру
@implementSkuLedger(shipment, sku, stock);
quantityInLIFOSkuLedger (ledger) += quantityShipmentDetail(ledger);
@implementSkuLedgerInLIFOBalance(shipment, sku, stock);
changedDataSkuLedger(ledger) += CHANGED(batchShipmentDetail(ledger));
sumInSkuLedger(ledger) += sumShipmentDetail(ledger);