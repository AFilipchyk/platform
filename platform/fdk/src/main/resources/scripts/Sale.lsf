MODULE Sale;

REQUIRE SaleShipment, SaleReturnShipment, SaleCreditNote, SaleReturnCreditNote
;

//-----------------------------------------------------------------------------------------------------------//


currentReserveSaleSkuStock 'Текущий резерв'(sku, stock)  = Sale.currentReserveSkuStock(sku, stock) (-)
    SaleReturn.currentReserveSkuStock(sku, stock);

NAVIGATOR {

    NEW saleSaleNavigator 'Продажи' {
        ADD Sale.orders;
        ADD Sale.invoices;
        ADD Sale.shipments;
        ADD Sale.creditNotes;
    }
    NEW saleReturnNavigator 'Возвраты' {
        ADD SaleReturn.orders;
        ADD SaleReturn.invoices;
        ADD SaleReturn.shipments;
        ADD SaleReturn.creditNotes;
    }
}


META defineDialogSkuSaleReserve (form)

    form###SaleReserve 'Резерв (продажи)' (sku) = currentReserveSaleSkuStock(sku, form###stock());

    EXTEND FORM form
        PROPERTIES(s) READONLY  form###SaleReserve AFTER form###balance SHOWIF form###stock()
    ;
END

@defineDialogSkuSaleReserve(dialogSku);




