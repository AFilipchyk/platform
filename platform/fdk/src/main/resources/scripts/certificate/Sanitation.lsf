MODULE Sanitation;

REQUIRE Certificate, Shipment;

CLASS sanitation 'ГГР' : certificate, numberedObject;
TABLE sanitation(sanitation);

@defineDocumentHeaderTimePrefix(sanitation, ,' создания');
@defineDocumentHeaderTimePrefix(sanitation, to, ' действия');
@implementDocumentHeaderTimePrefix(certificate, , sanitation, );
@implementDocumentHeaderTimePrefix(certificate, to, sanitation, to);
seriesCertificate(sanitation) += seriesObject(sanitation) AND sanitation IS sanitation;
numberCertificate(sanitation) += numberObject(sanitation) AND sanitation IS sanitation;

descriptionSanitation 'ГГР' (sanitation) =
    [FORMULA STRING[100] ' \'№\' || CAST($1 AS TEXT) ||  \' от \' || CAST($2 AS TEXT)||  \' действует по \' || CAST($3 AS TEXT)']
    (seriesNumberObject(sanitation), dateSanitation(sanitation), toDateSanitation(sanitation));

@defineCertificateBatch(sanitation, 'ГГР');

FORM sanitation 'ГГР'
    OBJECTS s = sanitation FIXED PANEL
    PROPERTIES(s) seriesObject, numberObject, dateSanitation, timeSanitation, toDateSanitation, toTimeSanitation
    EDIT sanitation OBJECT s
;

DESIGN sanitation FROM DEFAULT{
    main{
        ADD PROPERTY(seriesObject);
        ADD PROPERTY(numberObject);
        ADD PROPERTY(dateSanitation);
        ADD PROPERTY(timeSanitation);
        ADD PROPERTY(toDateSanitation);
        ADD PROPERTY(toTimeSanitation);
    }
    ADD functions.box;
}

FORM sanitations 'ГГР'
    OBJECTS s = sanitation
    PROPERTIES(s) READONLY seriesNumberObject, dateTimeSanitation, toDateTimeSanitation
    PROPERTIES(s) ADDFORM, EDITFORM, delete
;

FORM sanitationsDialog 'ГГР'
    OBJECTS s = sanitation
    PROPERTIES(s) READONLY seriesNumberObject, dateTimeSanitation, toDateTimeSanitation

    DIALOG sanitation OBJECT s
;

NAVIGATOR {
    certificateNavigator {
        ADD sanitations;
    }
}