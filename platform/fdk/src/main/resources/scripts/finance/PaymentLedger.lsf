MODULE PaymentLedger;

REQUIRE LegalEntity;

// ---------------- Счет ------------- //

CLASS ABSTRACT account 'Счет';
TABLE account (account);
nameAccount 'Имя' = ABSTRACT STRING[30] (account) PERSISTENT;

currencyAccount = ABSTRACT currency (account);
nameCurrencyAccount 'Валюта счета' = name(currencyAccount(account));

legalEntityAccount = ABSTRACT legalEntity (account);

// ---------------- Регистр денег ------------- //

CLASS ABSTRACT paymentLedger 'Движение денег';
TABLE paymentLedger(paymentLedger);

dateTimePaymentLedger 'Дата/время' = ABSTRACT DATETIME (paymentLedger) PERSISTENT;

legalEntityFromPaymentLedger = ABSTRACT legalEntity (paymentLedger) PERSISTENT;
nameLegalEntityFromPaymentLedger 'Организация-плательщик' = name(legalEntityFromPaymentLedger(ledger));

accountFromPaymentLedger = ABSTRACT account (paymentLedger) PERSISTENT;
nameAccountFromPaymentLedger 'Счет (с)' (ledger) = nameAccount(accountFromPaymentLedger(ledger));

legalEntityToPaymentLedger = ABSTRACT legalEntity (paymentLedger) PERSISTENT;
nameLegalEntityToPaymentLedger 'Организация-получатель' = name(legalEntityToPaymentLedger(ledger));

accountToPaymentLedger = ABSTRACT account (paymentLedger) PERSISTENT;
nameAccountToPaymentLedger 'Счет (на)' (ledger) = nameAccount(accountToPaymentLedger(ledger));

sumFromPaymentLedger 'Сумма (с)' = ABSTRACT NUMERIC[16,2] (paymentLedger) PERSISTENT;
sumToPaymentLedger 'Сумма (на)' = ABSTRACT NUMERIC[16,2] (paymentLedger) PERSISTENT;

descriptionPaymentLedger 'Описание' = ABSTRACT STRING[200] (paymentLedger) PERSISTENT;

FORM paymentLedger 'Движение денег'
    OBJECTS pl = paymentLedger
    PROPERTIES(pl) READONLY descriptionPaymentLedger, dateTimePaymentLedger, nameLegalEntityFromPaymentLedger, nameAccountFromPaymentLedger,
                            nameLegalEntityToPaymentLedger, nameAccountToPaymentLedger, sumFromPaymentLedger,
                            sumToPaymentLedger
;

NAVIGATOR {
    financeNavigator{
        ADD paymentLedger;
    }
}

EXTEND DESIGN legalEntity {
    extendContainer {
        NEW accountContainer{
            caption = 'Счета';
            childConstraints = TO THE RIGHT;
            type = SPLITH;
        }
    }
}
