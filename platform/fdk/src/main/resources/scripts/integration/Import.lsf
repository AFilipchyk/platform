MODULE Import;

REQUIRE System,
        Barcode,
        Compliance,
        Country,
        Currency,
        CustomsGroup,
        Employee,
        Integration,
        Item,
        LegalEntity,
        LegalEntityBy,
        Bank,
        Numerator,
        PriceList,
        PurchaseCompliance,
        PurchaseInvoice,
        PurchaseInvoiceCharge,
        PurchaseManufacturingPrice,
        PurchaseShipment,
        PurchaseWriteOff,
        PricingPurchase,
        SaleOrder,
        Stock,
        Store,
        Tax,
        TaxItem,
        Ware,
        Warehouse,
        WareInvoice,
        WareItem,
        WarePurchaseInvoice,
        WriteOffItem,
        PurchaseInvoiceWholesalePrice,
        PurchaseManufacturingPrice;

EXTEND CLASS Bank : Externalizable;
EXTEND CLASS Barcode : Externalizable;
EXTEND CLASS Brand : Externalizable;
EXTEND CLASS CalcPriceListType : Externalizable;
EXTEND CLASS ChainStores : Externalizable;
EXTEND CLASS DepartmentStore : Externalizable;
EXTEND CLASS Employee : Externalizable;
EXTEND CLASS Item : Externalizable;
EXTEND CLASS ItemGroup : Externalizable;
EXTEND CLASS LegalEntity : Externalizable;
EXTEND CLASS Position : Externalizable;
EXTEND CLASS Store : Externalizable;
EXTEND CLASS StoreType : Externalizable;
EXTEND CLASS UOM : Externalizable;
EXTEND CLASS UserContractSku : Externalizable;
EXTEND CLASS UserInvoiceDetail : Externalizable;
EXTEND CLASS UserPriceList : Externalizable;
EXTEND CLASS Ware : Externalizable;
EXTEND CLASS Warehouse : Externalizable;
EXTEND CLASS WarehouseGroup : Externalizable;
EXTEND CLASS WriteOffRate : Externalizable;

numberSeriesToUserInvoice (number, series) = GROUP AGGR userInvoice BY numberObject(userInvoice), seriesObject(userInvoice) WHERE userInvoice IS UserInvoice;

userPriceListDetailSkuSIDUserPriceListSID (sku, userPriceList) = GROUP AGGR userPriceListDetail BY sidExternalizable(skuUserPriceListDetail(userPriceListDetail)), sidExternalizable(userPriceListUserPriceListDetail(userPriceListDetail)) WHERE userPriceListDetail IS UserPriceListDetail;

storeTypeNameChainStores 'Формат магазина по имени и торговой сети' (name, chainStores) = GROUP AGGR storeType BY nameStoreType(storeType), sidExternalizable(storeType) WHERE storeType IS StoreType; ////

sidExternalizableBatch 'Внешний код' (batch) = ABSTRACT STRING[100] (Batch) PERSISTENT;

sidExternalizableBatch (batch) += sidExternalizable (invoiceDetailShipmentDetail(shipmentDetailShipmentBatch(batch))) IF batch IS ShipmentBatch;

EXTEND FORM legalEntities
    PROPERTIES (l) READONLY sidExternalizable BEFORE delete(l)
;

EXTEND FORM banks
    PROPERTIES (b) READONLY sidExternalizable BEFORE delete(b)
;

EXTEND FORM wares
    PROPERTIES (w) READONLY sidExternalizable BEFORE delete(w)
;

EXTEND FORM warehouses
    PROPERTIES (w) READONLY sidExternalizable BEFORE delete(w)
;

